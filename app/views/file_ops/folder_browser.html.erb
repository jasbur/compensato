<h3>Select from the folders below:</h3>

<h5><%=@base_directory.gsub("/media/ubuntu", "")%></h4>

<%unless @base_directory == "/media/ubuntu"%>
	<a href="#" id="directory_up">Up...</a>
	
	<script>
		document.getElementById("directory_up").onclick = function(){
					folder_browser_refresh("<%=@previous_directory.gsub(" ", "%20")%>");}
	</script>
<%end%>

<%counter = 0%>

<ul>
	<%@browser_directories.each{|directory|%>		
		<%counter = counter + 1%>

		<li><a href="#" id="folder_link_<%=counter%>"><%=directory.path.split("/").last%></a></li>
		<li class="folderBrowserSubLinks"><a href="#" id=<%="#{directory.path.gsub(" ", "%20")}_source_link"%>>Use as source</a> | <a href="#" id=<%="#{directory.path.gsub(" ", "%20")}_destination_link"%>>Use as destination</a> | <%=link_to "Open in browser", {:action => "open_file_browser", :directory => directory.path}, :target => "_blank"%> </li>
		
		<%unless @browser_directories.size == 0%>
			<script>
				$("#folder_link_<%=counter%>").click(function(){
					folder_browser_refresh("<%=directory.path.gsub(" ", "%20")%>");
				})
			
				document.getElementById("<%=directory.path.gsub(" ", "%20") + "_source_link"%>").onclick = function(){
						update_form_text_field("source_directory", "<%=directory.path%>");}
						
				document.getElementById("<%=directory.path.gsub(" ", "%20") + "_destination_link"%>").onclick = function(){
						update_form_text_field("destination_directory", "<%=directory.path%>");}
			</script>
		<%end%>
	<%}%>
</ul>
